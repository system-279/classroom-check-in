<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>E2Eテスト結果 - Classroom Check-in</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans JP', sans-serif; }
    .status-pass { color: #16a34a; }
    .status-fail { color: #dc2626; }
  </style>
</head>
<body class="bg-gray-50">
  <!-- ヘッダー -->
  <header class="bg-blue-600 text-white shadow-lg">
    <div class="max-w-6xl mx-auto px-4 py-6">
      <h1 class="text-2xl md:text-3xl font-bold">Classroom Check-in</h1>
      <p class="mt-2 text-blue-100">オンライン講座の入退室管理システム</p>
    </div>
  </header>

  <!-- ナビゲーション -->
  <nav class="bg-white shadow">
    <div class="max-w-6xl mx-auto px-4">
      <div class="flex space-x-4 overflow-x-auto">
        <a href="index.html" class="px-4 py-3 text-gray-600 hover:text-blue-600">ホーム</a>
        <a href="student-guide.html" class="px-4 py-3 text-gray-600 hover:text-blue-600">受講者ガイド</a>
        <a href="admin-guide.html" class="px-4 py-3 text-gray-600 hover:text-blue-600">管理者ガイド</a>
        <a href="architecture.html" class="px-4 py-3 text-gray-600 hover:text-blue-600">システム構成</a>
        <a href="e2e-test-results.html" class="px-4 py-3 text-blue-600 border-b-2 border-blue-600 font-medium">E2Eテスト</a>
      </div>
    </div>
  </nav>

  <!-- メインコンテンツ -->
  <main class="max-w-6xl mx-auto px-4 py-8">

    <!-- テスト概要 -->
    <section class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">E2Eテスト結果</h2>
      <p class="text-gray-600 leading-relaxed mb-4">
        本番環境（Cloud Run）に対して実施したエンドツーエンドテストの結果です。
        すべての主要ユースケースが正常に動作することを確認しています。
      </p>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
          <div class="text-3xl font-bold text-green-600">28</div>
          <div class="text-sm text-gray-600">テスト項目</div>
        </div>
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
          <div class="text-3xl font-bold text-green-600">28</div>
          <div class="text-sm text-gray-600">成功</div>
        </div>
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 text-center">
          <div class="text-3xl font-bold text-gray-400">0</div>
          <div class="text-sm text-gray-600">失敗</div>
        </div>
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
          <div class="text-3xl font-bold text-green-600">100%</div>
          <div class="text-sm text-gray-600">成功率</div>
        </div>
      </div>
      <div class="mt-4 text-sm text-gray-500">
        最終実行日時: 2026-01-16 JST
      </div>
    </section>

    <!-- 受講者フロー -->
    <section class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
        <span class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">&#10003;</span>
        受講者フロー
      </h2>
      <p class="text-gray-600 mb-4">受講者が講座に入室・退室する一連の操作をテストしました。</p>

      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">テスト項目</th>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">結果</th>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">確認内容</th>
            </tr>
          </thead>
          <tbody class="divide-y">
            <tr>
              <td class="px-4 py-3 font-medium">講座一覧取得</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">enabled/visibleな講座が取得できる</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">チェックイン（IN）</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">セッション作成、status=open</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">ハートビート送信</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">lastHeartbeatAt更新</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">チェックアウト（OUT）</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">status=closed、durationSec計算（37秒）</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">連続IN動作</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">alreadyOpen: trueで既存セッション返却（ADR-0012準拠）</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- 管理者フロー -->
    <section class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
        <span class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">&#10003;</span>
        管理者フロー
      </h2>
      <p class="text-gray-600 mb-4">管理者が行う各種管理操作をテストしました。</p>

      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">テスト項目</th>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">結果</th>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">確認内容</th>
            </tr>
          </thead>
          <tbody class="divide-y">
            <tr>
              <td class="px-4 py-3 font-medium">講座CRUD</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">作成/更新/削除、enabled=false時にvisible自動false</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">ユーザーCRUD</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">作成/詳細取得/更新/削除</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">受講登録管理</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">作成/更新/削除、講座・ユーザー存在確認</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">セッション管理</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">一覧取得、status絞り込み、強制クローズ（status=adjusted）</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">通知ポリシー管理</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">global/course/userスコープ対応、CRUD動作</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">ユーザー設定管理</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">通知設定取得/更新、タイムゾーン設定</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ユースケースシミュレーション -->
    <section class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
        <span class="w-8 h-8 bg-emerald-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">&#10003;</span>
        ユースケースシミュレーション（デモモード）
      </h2>
      <p class="text-gray-600 mb-4">デモモードを使用した実際の操作フローをテストしました。</p>

      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">テスト項目</th>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">結果</th>
              <th class="px-4 py-3 text-sm font-medium text-gray-600">確認内容</th>
            </tr>
          </thead>
          <tbody class="divide-y">
            <tr>
              <td class="px-4 py-3 font-medium">受講者：講座選択→セッション遷移</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">講座一覧からセッション画面へ正常に遷移</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">受講者：講座一覧表示</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">デモデータが正常に表示される</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">受講者：IN/OUTボタン表示</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">セッション画面でボタンが正常に表示</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">管理者：ダッシュボード統計</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">統計カードが正常に表示</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">管理者：サイドバーナビ</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">全ナビゲーションリンクが正常動作</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">管理者：講座/セッション/通知/許可リスト</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">各管理画面が正常に表示</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">デモモード：POST制限</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">POSTリクエストが正しくブロック（403）</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium">デモモード：DELETE制限</td>
              <td class="px-4 py-3"><span class="status-pass font-bold">&#10003; PASS</span></td>
              <td class="px-4 py-3 text-sm text-gray-600">DELETEリクエストが正しくブロック（403）</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- 確認済みビジネスロジック -->
    <section class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-bold text-gray-800 mb-4">確認済みビジネスロジック</h2>

      <div class="grid md:grid-cols-2 gap-4">
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <h3 class="font-bold text-blue-800 mb-2">連続IN防止</h3>
          <p class="text-sm text-gray-600">同一講座で既存openセッションがあれば再利用し、新規作成しない</p>
        </div>
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <h3 class="font-bold text-blue-800 mb-2">滞在時間計算</h3>
          <p class="text-sm text-gray-600">endTime - startTime を秒単位で自動計算</p>
        </div>
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <h3 class="font-bold text-blue-800 mb-2">管理者補正</h3>
          <p class="text-sm text-gray-600">status=adjusted でセッション強制クローズ可能</p>
        </div>
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <h3 class="font-bold text-blue-800 mb-2">visible自動制御</h3>
          <p class="text-sm text-gray-600">enabled=false 設定時に visible も自動的にfalseに</p>
        </div>
      </div>
    </section>

    <!-- テスト環境 -->
    <section class="bg-white rounded-lg shadow-md p-6">
      <h2 class="text-xl font-bold text-gray-800 mb-4">テスト環境</h2>

      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <tbody class="divide-y">
            <tr>
              <td class="px-4 py-3 font-medium text-gray-600 w-1/3">API</td>
              <td class="px-4 py-3">
                <code class="bg-gray-100 px-2 py-1 rounded text-sm">https://api-102013220292.asia-northeast1.run.app</code>
              </td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium text-gray-600">Web UI</td>
              <td class="px-4 py-3">
                <code class="bg-gray-100 px-2 py-1 rounded text-sm">https://web-102013220292.asia-northeast1.run.app</code>
              </td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium text-gray-600">認証方式</td>
              <td class="px-4 py-3">ヘッダ疑似認証（X-User-Id, X-User-Role）</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-medium text-gray-600">インフラ</td>
              <td class="px-4 py-3">Google Cloud Run（asia-northeast1）</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

  </main>

  <!-- フッター -->
  <footer class="bg-gray-800 text-gray-300 mt-12">
    <div class="max-w-6xl mx-auto px-4 py-8">
      <p class="text-center text-sm">
        Classroom Check-in - オンライン講座の入退室管理システム
      </p>
    </div>
  </footer>
</body>
</html>
